#!/usr/bin/env bash
# This script takes a domain and an optional subdomain and returns information about the subdomain

# Function to get and print subdomain information
get_subdomain_info() {
    local subdomain=$1
    local domain=$2
    local full_domain="${subdomain}.${domain}"
    local dig_output
    dig_output=$(dig "$full_domain" A +short)

    echo "Querying: $full_domain"
    echo "Dig output: $dig_output"

    if [ -n "$dig_output" ]; then
        local record_type="A"
        local destination
        destination=$(echo "$dig_output" | head -n 1)
        echo "The subdomain $subdomain is a $record_type record and points to $destination"
    else
        echo "The subdomain $subdomain does not have any records."
    fi
}

# Main script logic
if [ "$#" -lt 1 ]; then
    echo "Usage: $0 DOMAIN [SUBDOMAIN]"
    echo "If SUBDOMAIN is not provided, the script will check a predefined list of subdomains."
    exit 1
fi

DOMAIN=$1
SUBDOMAIN=$2

# Predefined list of subdomains
SUBDOMAINS=("www" "lb-01" "web-01" "web-02")

if [ -z "$SUBDOMAIN" ]; then
    for sub in "${SUBDOMAINS[@]}"; do
        get_subdomain_info "$sub" "$DOMAIN"
    done
else
    get_subdomain_info "$SUBDOMAIN" "$DOMAIN"
fi
